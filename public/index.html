<!DOCTYPE html>
<html>
  <head> <title> Titanic Visualization </title> </head>
  <body>
    <h1> Titanic Visualizations </h1>
    
    <div id="container">
    </div>
    <!-- <script src=""></script> -->
    <script>
      // ------------------------------------------------
      // Fetching data from Titanic Dataset 
      fetch('titanic-passengers.json')
      .then(res => res.json())
      .then(json => {
        handleData(json)
      })
      .catch(err => console.log(err.message))

      // -------------------------------------------------
      // Create Graph 
      function makeGraph(data, width = 900, height = 400) {
        const container = document.createElement('div')
        container.style.width = `${width}px`
        container.style.height = `${height}px`
        const step = width / data.length * 2
        container.style.position = 'relative'

        data.forEach((item, i) => {
          const el = document.createElement('div')
          container.appendChild(el)
          el.style.position = 'absolute'
          el.style.backgroundColor = item.color
          el.style.width = `${step}px`
          el.style.height = `${item.value}px`
          el.style.left = `${step * i}px`
          el.style.bottom = '0'
        });

        return container
      }

      // ----------------------------------
      // Handles data 
      function handleData(data) {
        // Takes data & returns necessary info only: fields
        const betterData = data.map(passengers => passengers.fields)

        // Takes data and returns passengers {value, color}
        const fareAndGender = betterData.map(passenger => {
          const value = passenger.fare
          const color = passenger.sex === 'male' ? '#3366ff' : 'pink'
          return { value, color } 
        })

        const ageAndClass = betterData.map(passenger => {
          const value = passenger.age
          let color;
          switch (passenger.pclass) {
            case 3:
              color = '#FFD700'
              break;
            case 2:
              color = '#C0C0C0'
              break;
            case 1:
              color = '#CD7f32'
              break;
          }
          return { value, color } 
        })

        // Assignment 2 make up your own

        // Asignment Stretch challenge make up another 

        const faresAndGenderGraph = makeGraph(fareAndGender)
        document.querySelector('body').appendChild(faresAndGenderGraph)

        const ageAndClassGraph = makeGraph(ageAndClass)
        document.querySelector('body').appendChild(ageAndClassGraph)
      }
    </script>
  </body>
</html>