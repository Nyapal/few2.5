<!DOCTYPE html>
<html>
  <head> <title> Titanic Visualization </title> </head>
  <body>
    <h1> Titanic Visualizations </h1>
    
    <div id="container">
    </div>
    <!-- <script src=""></script> -->
    <script>
      // ------------------------------------------------
      // Fetching data from Titanic Dataset 
      fetch('titanic-passengers.json')
      .then(res => res.json())
      .then(json => {
        handleData(json)
      })
      .catch(err => console.log(err.message))

      // -------------------------------------------------
      // Create Graph 
      function makeGraph(data, width = 900, height = 400) {
        const container = document.createElement('div')
        container.style.width = `${width}px`
        container.style.height = `${height}px`
        const step = width / data.length * 2
        container.style.position = 'relative'

        data.forEach((item, i) => {
          const el = document.createElement('div')
          container.appendChild(el)
          el.style.position = 'absolute'
          el.style.backgroundColor = item.color
          el.style.width = `${step}px`
          el.style.height = `${item.value}px`
          el.style.left = `${step * i}px`
          el.style.bottom = '0'
        });

        return container
      }

      // ----------------------------------
      // Handles data 
      function handleData(data) {
        const betterData = data.map(passengers => passengers.fields)

        const fareAndGender = betterData.map(passenger => {
          const value = passenger.fare
          const color = passenger.sex === 'male' ? '#3366ff' : 'pink'
          return { value, color } 
        })

        // const passengersByAgeAndClass = betterData.map(passenger => {
        //   // Assignments 1
        //   // value is age
        //   // color is set by pclass (Must use Switch!)
        //   return { value, color } 
        // })

        // Assignment 2 make up your own

        // Asignment Stretch challenge make up another 

        // const allPassengersFaresGraph = makeGraph(betterData, 'female', ['pink', '#3366ff'])
        const faresAndGenderGraph = makeGraph(fareAndGender)
        document.querySelector('body').appendChild(faresAndGenderGraph)

        // const passengersWithColors = makeGraph

        // const passengersAgeAndClassGraph = makeGraph(passengersByAgeAndClass)
        // document.querySelector('body').appendChild(passengersAgeAndClassGraph)
      }
    </script>
  </body>
</html>